<section class="login flex justify-center py-24">
  <div class="w-full max-w-2xl">
    <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
      <a href="#">
        <div class="flex items-center justify-center">
          <img
            title="Click to change photo."
            id="profile-img"
            src="/images/profiles/profile.png"
            alt="profile-img"
            style="
              width: 250px;
              height: 250px;
              border-radius: 50%;
              box-shadow: 0 0 10px 1px #ccc;
            "
          />
        </div>
      </a>

      <% if(messages.error) { %>
      <div class="text-red-500 text-sm mb-3"><%= messages.error %></div>
      <% } %>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
          Staff ID
        </label>
        <input
          type="text"
          <%= staffObject ? 'readonly' : '' %>
          placeholder="Enter Staff ID"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="staff-id"
          name="staff-id"
          value="<%= staffObject ? staffObject.staff_id : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
          Name
        </label>
        <input
          type="text"
          placeholder="Enter Name"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="name"
          name="name"
          value="<%= staffObject ? staffObject.name : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="age">
          Age
        </label>
        <input
          type="number"
          placeholder="Enter Age"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="age"
          name="age"
          value="<%= staffObject ? staffObject.age : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="email">
          Email
        </label>
        <input
          type="email"
          placeholder="Enter Email"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="mail"
          name="email"
          value="<%= staffObject ? staffObject.mail : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="mobile">
          Mobile
        </label>
        <input
          type="tel"
          placeholder="Enter Mobile Number"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="mobile"
          name="mobile"
          value="<%= staffObject ? staffObject.mobile : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label
          class="block text-gray-700 text-sm font-bold mb-2"
          for="identityType"
        >
          Identity Type
        </label>
        <input
          type="text"
          placeholder="Enter Identity Type"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="identityType"
          name="identityType"
          value="<%= staffObject ? staffObject.identitytype : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label
          class="block text-gray-700 text-sm font-bold mb-2"
          for="identityNumber"
        >
          Identity Number
        </label>
        <input
          type="text"
          placeholder="Enter Identity Number"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="identityNumber"
          name="identityNumber"
          value="<%= staffObject ? staffObject.identityno : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="address">
          Address
        </label>
        <input
          type="text"
          placeholder="Enter Address"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="address"
          name="address"
          value="<%= staffObject ? staffObject.address : '' %>"
          required
        />
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="pincode">
          Pincode
        </label>
        <input
          type="text"
          placeholder="Enter Pincode"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
          id="pincode"
          name="pincode"
          value="<%= staffObject ? staffObject.pincode : '' %>"
          required
        />
      </div>

      <% if(!staffObject) { %>
        <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="pincode">
              Password
            </label>
            <input
              type="text"
              placeholder="Enter password"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              id="password"
              name="password"
              value="<%= staffObject ? staffObject.password : '' %>"
              required
            />
          </div>
          <% } %>

      <% if(staffObject){ %>
      <div class="flex items-center justify-between">
        <a href="/admin/deletestaff/<%= staffObject.staff_id %>">
          <button
            type="button"
            class="btn rounded-full text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          >
            Delete
          </button>
        </a>
        <button
          id="submitBtn"
          class="btn rounded-full text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          type="button"
        >
          Update
        </button>
      </div>
      <% } else { %>
      <div class="flex items-center justify-end">
        <button
          id="submitBtn"
          class="btn rounded-full text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          type="button"
        >
          Add
        </button>
      </div>
      <% } %>
    </div>
    <p class="text-center text-gray-500 text-xs">
      &copy;2024 Restaurant Mgmt Systems. All rights reserved.
    </p>
  </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  document.getElementById("submitBtn").addEventListener("click", async () => {
    const staff_id = document.getElementById("staff-id").value.trim();
    const name = document.getElementById("name").value;
    const age = document.getElementById("age").value;
    const mail = document.getElementById("mail").value;
    const mobile = document.getElementById("mobile").value;
    const identity = document.getElementById("identityType").value;
    const identityno = document.getElementById("identityNumber").value;
    const address = document.getElementById("address").value;
    const pincode = document.getElementById("pincode").value;
    const passwordDiv = document.getElementById("password");
    const password = passwordDiv ? passwordDiv.value : "";
    console.log(staff_id)

    if (!passwordDiv) {
      // If ID exists, make a PATCH request
      try {
        const response = await axios.patch(`/admin/staff/${staff_id}`, {
          name,
          age,
          mail,
          mobile,
          identity,
          identityno,
          address,
          pincode,
        });
        console.log("PATCH Request Successful");
        console.log(response.data);
      } catch (error) {
        console.error("Error making PATCH request:", error);
      }
    } else {
      // If ID doesn't exist, make a POST request
      try {
        const response = await axios.post("/admin/staff", {
          staff_id,
          name,
          age,
          mail,
          mobile,
          identity,
          identityno,
          address,
          pincode,
          password
        });
        console.log("POST Request Successful");
        console.log(response.data);
      } catch (error) {
        console.error("Error making POST request:", error);
      }
    }
  });
</script>
